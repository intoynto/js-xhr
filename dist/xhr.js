!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("xhr",[],t):"object"==typeof exports?exports.xhr=t():e.xhr=t()}(self,(function(){return(()=>{"use strict";var e={441:function(e,t,r){var n=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r};Object.defineProperty(t,"__esModule",{value:!0}),t.ajax=void 0;var s=r(991),o=r(148),a=r(529);t.ajax=function(e){var t=function(e){(0,s.getObserve)().listen(e)};return new Promise((function(r,s){(function(e){var t=n(e,[]);return new Promise((function(e,r){var n,s=(t.method?t.method:t.type?t.type:"GET").toString().toUpperCase().trim(),i=t.responseType||"json",c=t.params&&"object"==typeof t.params?t.params:t.data&&"object"==typeof t.data?t.data:null,l=null!=c,p="json"===(i||"").toLowerCase().trim(),f=(t.url||"").toString().trim();if(t.formElement){n=new FormData(t.formElement);var u=t.formElement.querySelectorAll("input[type=file]"),d=[];if(u.length>0)for(var v=0;v<u.length;v++){var m=u[v];m.files&&m.files.length>0&&m.files[0]||d.push(m.name)}for(v=0;v<d.length;v++)n.delete(d[v])}else t.formData&&(n=t.formData);if(l)if(n)(0,o.createFormData)(c,n);else if("GET"===s){var h=(0,a.serialize)(c);h.length>0&&(f.indexOf("?")<0&&(f+="?"),f+=h)}else n=(0,o.createFormData)(c);var g=new XMLHttpRequest;if(g.open(s,f),t.headers)for(var y in t.headers)g.setRequestHeader(y,t.headers[y]);p&&g.setRequestHeader("accept","application/json"),e({xhr:g,formData:n,handleToJson:p})}))})(e).then((function(n){var o=n.handleToJson,a=n.xhr,i=n.formData;if(a.addEventListener("loadend",(function(e){var n,i=e.target,c={title:"Throw",status:a.status,code:a.status,statusText:a.statusText,message:a.statusText,description:"",xhr:a},l=200===i.status;if("json"!==i.responseType.toString().toLowerCase()){var p=i.getResponseHeader("content-type");(p=p?p.toString().toLowerCase().trim():"").split(";"),n=p.indexOf("application/json")>0}if(l)if(o||n){if((a.responseText||"").toString().trim().length<1)return c.message="Tidak ada result dari server.",t(i),void s(c);try{var f=JSON.parse(a.responseText);t(i),r(f)}catch(e){c.code=409,c.message="Parse error. "+(e.message?e.message:"Unknown error."),t(i),s(c)}}else t(i),r(a.response);else{c.title="Throw "+a.status;try{var u=JSON.parse(a.responseText);if("object"==typeof u){var d=Array.isArray(u.exception)?u.exception[0]:null;d?(c.message=d.message,c.description=d.description?d.description:d.message):(c.message=u.error&&u.error.message?u.error.message:u.message?u.message:c.message,c.description=u.error&&u.error.description?u.error.description:u.description?u.description:c.description)}t(u),s(c)}catch(e){t(i),s(c)}}})),a.addEventListener("error",(function(e){var r=e.target;t(r),s({title:"Throw",message:"Unknown error.",xhr:r})})),"function"==typeof e.uploadProgress){var c=e.uploadProgress;a.upload.addEventListener("progress",(function(e){var t=e.loaded,r=e.total;c({loaded:t,total:r,percentage:t/r*100})}))}a.send(i)})).catch((function(e){s({title:"Throw",message:e&&e.message?e.message:"Unknown error."})}))}))}},148:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createFormData=void 0,t.createFormData=function e(t,r,n){var s=r||new FormData;for(var o in t){var a=n?"".concat(n,"[").concat(o,"]"):o;if(t[o]instanceof Date)s.append(a,t[o].toString());else if(Array.isArray(t[o])&&t[o].length>0)for(var i=t[o],c=0;c<i.length;c++)"object"==typeof i[c]?e(i[c],s,"".concat(a,"[").concat(c,"]")):s.append("".concat(a,"[]"),i[c]);else if("object"!=typeof t[o]||t[o]instanceof File){var l=t[o];null!=l&&s.append(a,l)}else e(t[o],s,a)}return s}},991:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getObserve=t.ajax=void 0;var n=r(441);Object.defineProperty(t,"ajax",{enumerable:!0,get:function(){return n.ajax}});var s=r(42);Object.defineProperty(t,"getObserve",{enumerable:!0,get:function(){return s.getObserve}})},42:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getObserve=void 0;var r=function(){function e(){this.listenerKeys=[],this.listenters={},this.subscribe=this.subscribe.bind(this),this.unSubscribe=this.unSubscribe.bind(this),this.listen=this.listen.bind(this)}return e.prototype.subscribe=function(e){var t=Math.random().toString(36);return this.listenters[t]=e,t},e.prototype.unSubscribe=function(e){var t=this.listenerKeys.indexOf(e);t>=0&&(this.listenerKeys.splice(t),delete this.listenters[e])},e.prototype.listen=function(e){for(var t in this.listenters){var r=this.listenters[t];if("function"==typeof r)try{r(e)}catch(e){}}},e}(),n=null;t.getObserve=function(){return n||(n=new r),n}},529:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=void 0,t.serialize=function e(t,r,n){if(n=n||[],"object"==typeof t)for(var s in t){var o=t[s];null!=o&&e(o,r?r+"["+s+"]":s,n)}else n.push(r+="="+encodeURIComponent(t));return n.join("&")}}},t={};var r=function r(n){var s=t[n];if(void 0!==s)return s.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}(991);return r})()}));
//# sourceMappingURL=xhr.js.map